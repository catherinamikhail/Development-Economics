---
title: "Group Data Assignment Week 3"
author: "Catherina Mikhail 2847118, Sinem Göral 2817932, Ela Köycü 2846357"
date: "2025-11-12"
output:
  word_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,      
  warning = FALSE, 
  message = FALSE,  
  results = 'markup' 
)
# First we need to make sure that some packages (=places where e.g. commands are 
#saved) are available, for this, we need to install them
#for this, we create a variable called check, (see in your Enviroment 
#what value it takes after having run the line), it takes TRUE if the package is 
#already installed and FALSE if not
check <- require('survey')
#next, we have a loop that has a condition (!check, this condition is TRUE if check is FALSE and FALSE if check is TRUE)
#i.e. if it is already installed, the loop will not do anything, if it is not instaled, it will install it
#Depending on your version, you might need to enter YES in the console to confirm that you want to install it
if(!check) {
     install.packages('survey')
}
#just because it is installed does not mean that it is loaded into your current session (the one you run this file in), therefore we execute the following code
library(survey)  
#to learn about the package
?survey

#now to the next package that will allow us to load the files we have easily into R
check <- require('readstata13')
#if not installed, install the package, this needs to be confirmed by typing in yes in the command console, after having run the following line
if(!check) {
       install.packages('readstata13')
     }
library('readstata13')  
#to learn about the package
?readstata13

#some housekeeping
rm(check)

# now finally: Read in data

#for this: we create the filepath either per hand, see the line below, 
#or we use the point-and-shoot-option (often easier if you donot feel comfortable with R or coding yet)

#statafile <- 'u:/interim files/Tanzania 2012.dta' #if you want to use this, delete the # at the beginning and type in the correct path
statafile2012 <- file.choose() #allows for clicking on it in a window, no need to have the path ready, click here on the file "Tanzania_2012.dta"
#load it
statafile2018 <- file.choose() #click here on the file "Tanzania_2018.dta"
tzdata2012 <- read.dta13(statafile2012,nonint.factors = T)
tzdata2018 = read.dta13(statafile2018,nonint.factors = T)
  
# Remove observations with missing data 
tzdata2012 <- na.omit(tzdata2012)
tzdata2018 <- na.omit(tzdata2018)
#create population-weight (popwt) as a variable
tzdata2012$popwt <- with(tzdata2012,hhsize*hhweight)
tzdata2018$popwt <- with(tzdata2018,hhsize*hhweight)
                          
#incorporate the surveydesign: for this, use the information about strata, weights and ID from the data
tzdesign2012 <- svydesign(id = ~CLUSTER, strata = ~STRATUM, weights = ~popwt, nest =T,  data = tzdata2012)
tzdesign2018 <- svydesign(id = ~CLUSTER, strata = ~STRATUM, weights = ~popwt, nest = T, data = tzdata2018)
#

#This is the end for the first round of the survey (either 2012 and 2018), 
#now you will have to repeat the code for the other round, however, no need to load (or install) the packages again, good luck!

```

1.a. Using the data files on Tanzania, we have computed the headcount, poverty gap and squared poverty gap on the national level.

-   We used the formula H = q/N, where q is the amount of people considered poor and N the total population. For 2012 we discovered that around 28.17% of the population is considered poor using the headcount method. For 2018 we discovered that around 26.39% of the population is considered poor using the headcount method.

```{r Headcount National, echo=TRUE}
## National headcount for 2012
# First we determine which households are poor by looking at who's consumption is below the poverty line
tzdata2012$poor <- ifelse(tzdata2012$cons <= tzdata2012$povline, 1, 0)
# Then we calculate the amount of people those households represent
sum(tzdata2012$popwt * tzdata2012$poor, na.rm = TRUE)
# Then we calculate the headcount H = q/N
sum(tzdata2012$popwt * tzdata2012$poor, na.rm = TRUE)/sum(tzdata2012$popwt)

## National headcount for 2012
# First we determine which households are poor by looking at who's consumption is below the poverty line
tzdata2018$poor <- ifelse(tzdata2018$cons <= tzdata2018$povline, 1, 0)
# Then we calculate the amount of people those households represent
sum(tzdata2018$popwt * tzdata2018$poor, na.rm = TRUE)
# Then we calculate the headcount H = q/N
sum(tzdata2018$popwt * tzdata2018$poor, na.rm = TRUE)/sum(tzdata2018$popwt)
```

-   We used the formula 1/N \* sum(q \* (z / (z - y))), where z is the poverty line and y is consumption, to compute the poverty gap. For 2012 we discovered that the average poor person is falling short of the poverty line by 6.70%. For 2018 we discovered that the average poor person is falling short of the poverty line by 6.16%.

```{r Poverty Gap National, echo=TRUE}
## National Poverty Gap for 2012
# First we determine the gap ratio = (poverty line - consumption)/poverty line for all people considered poor
tzdata2012$gapratio <- with(tzdata2012, (povline-cons)/povline * tzdata2012$poor)
# Then we calculate the poverty gap by PG= 1/N * (gap ratio * weighted population)
(1/sum(tzdata2012$popwt)) * sum(tzdata2012$gapratio * tzdata2012$popwt)

## National Poverty Gap for 2018
# First we determine the gap ratio = (poverty line - consumption)/poverty line for all people considered poor
tzdata2018$gapratio <- with(tzdata2018, (povline-cons)/povline * tzdata2018$poor)
# Then we calculate the poverty gap by PG= 1/N * (gap ratio * weighted population)
(1/sum(tzdata2018$popwt)) * sum(tzdata2018$gapratio * tzdata2018$popwt)

```

-   We used the formula 1/N \* sum(q \* ((z / (z - y))\^2)) to compute the squared poverty gap. For 2012 we discovered that on average, the income shortfall of poor households relative to the poverty line is 12.82% when giving greater weight to the poorest. For 2018 this was 11.83%.

```{r Squared Povert Gap National, echo=TRUE}
## National Poverty Gap for 2012
# First we determine the square gap ratio = (poverty line - consumption)/poverty)^2 / poverty line for all people considered poor
tzdata2012$squaregapratio <- with(tzdata2012, (sqrt((povline-cons)/povline * tzdata2012$poor)))
# Then we calculate the square poverty gap by PG= 1/N * (square gap ratio * weighted population)
(1/sum(tzdata2012$popwt)) * sum(tzdata2012$squaregapratio * tzdata2012$popwt)

## National Poverty Gap for 2018
# First we determine the square gap ratio = (poverty line - consumption)/poverty)^2 / line for all people considered poor
tzdata2018$squaregapratio <- with(tzdata2018, (sqrt((povline-cons)/povline * tzdata2018$poor)))
# Then we calculate the square poverty gap by PG= 1/N * (square gap ratio * weighted population)
(1/sum(tzdata2018$popwt)) * sum(tzdata2018$squaregapratio * tzdata2018$popwt)
```

1.b. Using the data files on Tanzania, we have computed the headcount, poverty gap and squared poverty gap on the area level.

-   Looking at the headcount per area we have discovered for 2012 33.29% in rural areas, 21.69% in urban areas and 4.11% in Dar es Salaam are considered poor. For 2018 31.35% in rural areas, 19.22% in urban areas and 7.98% in Dar es Salaam is considered poor.

```{r Headcount Area, echo=TRUE}
# Headcount per area 2012
library(tidyverse)
tzdata2012 %>%
  group_by(STRATUM) %>%
  summarise(headcount = sum(popwt * poor, na.rm = TRUE)/sum(popwt))
# Headcount per area 2018
tzdata2018 %>%
  group_by(STRATUM) %>%
  summarise(headcount = sum(popwt * poor, na.rm = TRUE)/sum(popwt))
```

-   Computing the poverty gap per area we found out that for 2012 the average poor person is falling short of the poverty line by 7.84% in rural areas, 5.51% in urban areas and 0.83% in Dar es Salaam. For 2018 the average poor person is falling short of the poverty line by 7.40% in rural areas, 4.16% in urban areas and 2.03% in Dar es Salaam.

```{r Poverty Gap Area, echo=TRUE}
# Poverty gap per area 2012
tzdata2012 %>%
  group_by(STRATUM) %>%
  summarise(poverty_gap = (1/sum(popwt)) * sum(gapratio * popwt))
# Poverty gap per area 2012
tzdata2018 %>%
  group_by(STRATUM) %>%
  summarise(poverty_gap = (1/sum(popwt)) * sum(gapratio * popwt))
```

-   Computing the squared poverty gap per area we discovered that for 2012 on average, the income shortfall of poor households relative to the poverty line is 15.11% in rural areas, 10.09% in urban areas and 1.69% in Dar es Salaam. For 2018 on average, the income shortfall of poor households relative to the poverty line is 14.14% in rural areas, 8.22% in urban areas and 3.84% in Dar es Salaam.

```{r Squared Poverty Gap Area, echo=TRUE}
# Squared poverty gap per area 2012
tzdata2012 %>%
  group_by(STRATUM) %>%
  summarise(squared_poverty_gap = (1/sum(popwt)) * sum(squaregapratio * popwt))
# Squared poverty gap per area 2018
tzdata2018 %>%
  group_by(STRATUM) %>%
  summarise(squared_poverty_gap = (1/sum(popwt)) * sum(squaregapratio * popwt))
```

1.c. Using the data files on Tanzania, we have computed the headcount, poverty gap and squared poverty gap on the region level.

-   Looking at the headcount per area we have discovered for 2012 34.60% in Dodoma, 21.89% in Arusha, 11.38% in Kilimanjaro, 30.74% in Tanga, 11.13% in Morogoro, 16.01% in Pwani, 4.11% in Dar es Salaam, 17.74% in Lindi, 41.39% in Mtwara and 53.65% in Ruvumaare considered poor. For 2018 23.19% in Dodoma, 24.65% in Arusha, 10.52% in Kilimanjaro, 20.95% in Tanga, 19.31% in Morogoro, 27.88% in Pwani, 7.98% in Dar es Salaam, 38.01% in Lindi, 29.14% in Mtwara and 30.60% in Ruvumaare considered poor.

```{r Headcount Region, echo=TRUE}
# Headcount per region 2012
tzdata2012 %>%
  group_by(region) %>%
  summarise(headcount = sum(popwt * poor, na.rm = TRUE)/sum(popwt))
# Headcount per region 2018
tzdata2018 %>%
  group_by(region) %>%
  summarise(headcount = sum(popwt * poor, na.rm = TRUE)/sum(popwt))
```

-   Computing the poverty gap per area we found out that for 2012 the average poor person is falling short of the poverty line by 7.09% in Dodoma, 6.02% in Arusha, 1.81% in Kilimanjaro, 6.78% in Tanga, 2.38% in Morogoro, 3.53% in Pwani, 0.82% in Dar es Salaam, 2.19% in Lindi, 11.83% in Mtwara and 15.55% in Ruvumaare considered poor. For 2018 the average poor person is falling short of the poverty line by 4.05% in Dodoma, 5.75% in Arusha, 1.66% in Kilimanjaro, 5.06% in Tanga, 3.68% in Morogoro, 8.73% in Pwani, 2.03% in Dar es Salaam, 9.58% in Lindi, 5.93% in Mtwara and 6.69% in Ruvumaare considered poor.

```{r Poverty Gap Region, echo=TRUE}
# Poverty gap per region 2012
tzdata2012 %>%
  group_by(region) %>%
  summarise(poverty_gap = (1/sum(popwt)) * sum(gapratio * popwt))
# Poverty gap per region 2018
tzdata2018 %>%
  group_by(region) %>%
  summarise(poverty_gap = (1/sum(popwt)) * sum(gapratio * popwt))
```

-   Computing the squared poverty gap per area we discovered that for 2012 on average, the income shortfall of poor households relative to the poverty line is 14.65% in Dodoma, 10.70% in Arusha, 4.12% in Kilimanjaro, 13.52% in Tanga, 4.78% in Morogoro, 6.92% in Pwani, 1.69% in Dar es Salaam, 5.70% in Lindi, 20.17% in Mtwara and 26.99% in Ruvumaare. For 2018 on average, the income shortfall of poor households relative to the poverty line is 8.82% in Dodoma, 11.07% in Arusha, 3.83% in Kilimanjaro, 9.62% in Tanga, 7.75% in Morogoro, 14.81% in Pwani, 3.84% in Dar es Salaam, 18.01% in Lindi, 11.75% in Mtwara and 13.22% in Ruvumaare.

```{r Squared Poverty Gap Region, echo=TRUE}
# Squared poverty gap per region 2012
tzdata2012 %>%
  group_by(region) %>%
  summarise(squared_poverty_gap = (1/sum(popwt)) * sum(squaregapratio * popwt))
# Squared poverty gap per region 2018
tzdata2018 %>%
  group_by(region) %>%
  summarise(squared_poverty_gap = (1/sum(popwt)) * sum(squaregapratio * popwt))
```

2. Policy Note: Poverty Trends in Tanzania (2012-2018)
Between 2012 and 2018, Tanzania experienced a slight decline in poverty at the national level across all three poverty measures. The headcount ratio decreased from 28.17% to 26.39%, indicating that approximately 1.78 percentage points fewer people lived below the poverty line. The poverty gap improved from 6.70% to 6.16%, suggesting that the average poor person moved slightly closer to the poverty line. Similarly, the squared poverty gap declined from 12.82% to 11.83%, demonstrating a reduction in the severity of poverty among the poorest households.
While these improvements are encouraging, the pace of poverty reduction remains relatively slow, with the poorest segments of the population continuing to face significant income shortfalls.
Regions with Poverty Reduction:
-	Dodoma achieved substantial progress, with the headcount ratio falling from 34.60% to 23.19%. The poverty gap improved from 7.09% to 4.05%, and the squared poverty gap declined from 14.65% to 8.82%.
-	Ruvuma saw significant improvement, with the headcount decreasing from 53.65% to 30.60% (a 23.05 percentage point reduction). The poverty gap fell from 15.55% to 6.69%, and the squared poverty gap declined from 26.99% to 13.22%.
-	Tanga reduced its headcount from 30.74% to 20.95%, with corresponding improvements in the poverty gap (6.78% to 5.06%) and squared poverty gap (13.52% to 9.62%).
-	Mtwara experienced a substantial decline from 41.39% to 29.14% in the headcount ratio, though poverty remains high.
Regions with Poverty Increases:
-	Dar es Salaam experienced a worrying doubling of poverty, with the headcount rising from 4.11% to 7.98%. The poverty gap increased from 0.82% to 2.03%, and the squared poverty gap nearly tripled from 1.69% to 3.84%.
-	Pwani saw poverty rise sharply, with the headcount increasing from 16.01% to 27.88%. The poverty gap grew from 3.53% to 8.73%, and the squared poverty gap more than doubled from 6.92% to 14.81%.
-	Arusha experienced a slight increase from 21.89% to 24.65% in the headcount ratio, with the poverty gap rising from 6.02% to 5.75%.
-	Lindi saw poverty worsen significantly, with the headcount rising from 17.74% to 38.01%, the poverty gap from 2.19% to 9.58%, and the squared poverty gap from 5.70% to 18.01%.
Regions with Modest Changes:
-	Morogoro experienced increasing poverty, with the headcount rising from 11.13% to 19.31%.
-	Kilimanjaro maintained relatively stable and low poverty levels, with only a slight decrease from 11.38% to 10.52%.
The urban-rural divide reveals important patterns:
-	Rural areas saw modest improvement, with the headcount declining from 33.29% to 31.35%, the poverty gap from 7.84% to 7.40%, and the squared poverty gap from 15.11% to 14.14%.
-	Urban areas (excluding Dar es Salaam) experienced improvements, with the headcount falling from 21.69% to 19.22%, the poverty gap from 5.51% to 4.16%, and the squared poverty gap from 10.09% to 8.22%.
-	Dar es Salaam, as noted, experienced deteriorating conditions across all measures.
The three poverty measures (headcount, poverty gap, and squared poverty gap) generally tell a consistent story at both national and regional levels. When poverty increased in a region, all three measures typically worsened, and when poverty declined, all three measures improved. This consistency suggests that poverty changes affected not just the number of poor people but also the depth and severity of their poverty.
However, the squared poverty gap, which is more sensitive to changes among the extremely poor, shows that even in regions with overall poverty reduction, the poorest households often remain deeply impoverished. For example, in Ruvuma, despite significant overall improvement, the squared poverty gap of 13.22% in 2018 indicates that extreme poverty persists.
In short, Tanzania’s poverty situation between 2012 and 2018 is quite uneven. On the national level, the numbers suggest some progress, but this hides big differences between regions. Some rural areas, such as Ruvuma and Dodoma, managed to reduce poverty a lot, showing that interventions can work. On the other hand, places like Dar es Salaam and Pwani indeed saw poverty increase, meaning economic growth did not reach everyone. The fact that all three poverty measures show similar trends makes these patterns more reliable. It additionally shows that when poverty rises, it does not just mean more people are poor, it also means those who are poor fall deeper below the poverty line. Extreme poverty is still a major problem: even in regions that improved overall, the poorest households remain trapped in severe deprivation. This suggests that development in Tanzania has been unequal, both geographically and economically, with growth benefiting some areas more than others. Going forward, Tanzania will need targeted strategies that focus on the specific needs of each region and address both how many people are poor and how poor they are, while making sure urbanization and economic growth benefit everyone.


3. We have computed the stratum- and region-level contribution to the national headcount rate. 

- The area level contribution to the national headcount rate for 2012 is 33.29% in rural areas, 21.69% in urban areas and 4.11% in Dar es Salaam. For 2018 the contribution to the national headcount rate is 31.35% in rural areas, 19.22% in urban areas and 7.98% in Dar es Salaam.
```{r stratum level contribution}
# stratum level contribution 2012
tzdata2012 %>%
  group_by(STRATUM) %>%
  summarise(contribution = ((sum(popwt * poor))/sum(popwt)) * 100)
# stratum level contribution 2018
tzdata2018 %>%
  group_by(STRATUM) %>%
  summarise(contribution = ((sum(popwt * poor))/sum(popwt)) * 100)
```
- The region level contribution to the national headcount rate for 2012 is 34.60% in Dodoma, 21.89% in Arusha,	11.38% in Kilimanjaro, 30.74% in Tanga, 11.13% in Morogoro, 16.01% in Pwani, 4.11% in Dar Es Salaam, 17.74% in Lindi, 41.39% in Mtwara and 53.65 in Ruvuma. For 2018 is 23.19% in Dodoma, 24.65% in Arusha,	10.52% in Kilimanjaro, 20.95% in Tanga, 19.31% in Morogoro, 27.88% in Pwani, 7.98% in Dar Es Salaam, 38.01% in Lindi, 29.14% in Mtwara and 30.60 in Ruvuma.  
```{r region level contribution}
# region level contribution 2012
tzdata2012 %>%
  group_by(region) %>%
  summarise(contribution = ((sum(popwt * poor))/sum(popwt)) * 100)
# region level contribution 2018
tzdata2018 %>%
  group_by(region) %>%
  summarise(contribution = ((sum(popwt * poor))/sum(popwt)) * 100)
```

4. Policy Recommendations
1. Invest in Rural Infrastructure and Agriculture
Given that rural areas continue to show the highest poverty rates (31.35% in 2018), targeted investments should focus on improving rural roads, irrigation systems, and access to markets. Expanding agricultural extension services, microfinance programs, and subsidized inputs such as seeds and fertilizers could raise productivity and rural incomes. Regions like Ruvuma and Mtwara, which depend heavily on agriculture and still face high poverty despite improvements, would particularly benefit from these measures.
2. Support Inclusive Urban Growth
The doubling of poverty in Dar es Salaam (from 4.11% to 7.98%) signals an urgent need for more inclusive urban planning. The government should promote vocational training programs for youth and expand small-business credit schemes to support entrepreneurship. Policies encouraging affordable housing projects, public transportation, and formal employment opportunities would help urban residents benefit more evenly from economic growth and prevent the marginalization of urban poor.
3. Implement Region-Specific Development Strategies
Each region faces distinct challenges requiring tailored approaches:
-	Pwani, with poverty increasing from 16.01% to 27.88%, needs urgent attention through industrial development and agricultural diversification.
-	Lindi, where poverty surged from 17.74% to 38.01%, requires comprehensive interventions focusing on economic diversification and improved market access.
-	Arusha, experiencing slight increases despite its tourism potential, could benefit from policies ensuring tourism revenues reach local communities.
Regional poverty reduction funds should be established to ensure local governments can address specific needs effectively.
4. Strengthen Social Protection Systems
To address the depth and severity of poverty, particularly important given the slow decline in squared poverty gaps, Tanzania should expand cash transfer programs, food assistance, and community-based social safety nets. Conditional cash transfers linked to school attendance and healthcare usage could help break the intergenerational cycle of poverty, especially in regions where extreme poverty persists.
5. Focus on Human Capital Development
Investing in education, healthcare, and nutrition programs, particularly for children and women in rural regions and areas with high squared poverty gaps, would have long-term effects on productivity and poverty reduction. Introducing more scholarships for rural youth and improving health infrastructure could reduce inequality between regions and help lift the extremely poor out of severe deprivation.




